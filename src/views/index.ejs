<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Process Run Overview</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              border: "hsl(var(--border))",
              input: "hsl(var(--input))",
              ring: "hsl(var(--ring))",
              background: "hsl(var(--background))",
              foreground: "hsl(var(--foreground))",
              primary: {
                DEFAULT: "hsl(var(--primary))",
                foreground: "hsl(var(--primary-foreground))",
              },
              secondary: {
                DEFAULT: "hsl(var(--secondary))",
                foreground: "hsl(var(--secondary-foreground))",
              },
              destructive: {
                DEFAULT: "hsl(var(--destructive))",
                foreground: "hsl(var(--destructive-foreground))",
              },
              muted: {
                DEFAULT: "hsl(var(--muted))",
                foreground: "hsl(var(--muted-foreground))",
              },
              accent: {
                DEFAULT: "hsl(var(--accent))",
                foreground: "hsl(var(--accent-foreground))",
              },
              popover: {
                DEFAULT: "hsl(var(--popover))",
                foreground: "hsl(var(--popover-foreground))",
              },
              card: {
                DEFAULT: "hsl(var(--card))",
                foreground: "hsl(var(--card-foreground))",
              },
            },
            borderRadius: {
              lg: "var(--radius)",
              md: "calc(var(--radius) - 2px)",
              sm: "calc(var(--radius) - 4px)",
            },
          },
        },
      };
    </script>
    <style>
      :root {
        --background: 0 0% 100%;
        --foreground: 222.2 84% 4.9%;
        --card: 0 0% 100%;
        --card-foreground: 222.2 84% 4.9%;
        --popover: 0 0% 100%;
        --popover-foreground: 222.2 84% 4.9%;
        --primary: 222.2 47.4% 11.2%;
        --primary-foreground: 210 40% 98%;
        --secondary: 210 40% 96.1%;
        --secondary-foreground: 222.2 47.4% 11.2%;
        --muted: 210 40% 96.1%;
        --muted-foreground: 215.4 16.3% 46.9%;
        --accent: 210 40% 96.1%;
        --accent-foreground: 222.2 47.4% 11.2%;
        --destructive: 0 84.2% 60.2%;
        --destructive-foreground: 210 40% 98%;
        --border: 214.3 31.8% 91.4%;
        --input: 214.3 31.8% 91.4%;
        --ring: 222.2 84% 4.9%;
        --radius: 0.5rem;
      }
    </style>
  </head>
  <body class="bg-background text-foreground min-h-screen">
    <div class="container mx-auto p-4 md:p-6 lg:p-8 max-w-7xl">
      <!-- Header -->
      <div class="mb-6">
        <h1 class="text-3xl font-bold tracking-tight">Process Run Overview</h1>
        <p class="text-muted-foreground mt-1">
          Monitor and track all process runs
        </p>
      </div>

      <% if (processRuns && processRuns.length > 0) { %>
      <!-- Stats Cards -->
      <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6">
        <div class="bg-card text-card-foreground rounded-lg border p-6">
          <div class="flex flex-col space-y-1.5">
            <div class="text-sm font-medium text-muted-foreground">
              Total Runs
            </div>
            <div class="text-2xl font-bold"><%= processRuns.length %></div>
          </div>
        </div>
        <div class="bg-card text-card-foreground rounded-lg border p-6">
          <div class="flex flex-col space-y-1.5">
            <div class="text-sm font-medium text-muted-foreground">
              Completed
            </div>
            <div class="text-2xl font-bold text-green-600">
              <%= processRuns.filter(r => r.status === 'COMPLETED').length %>
            </div>
          </div>
        </div>
        <div class="bg-card text-card-foreground rounded-lg border p-6">
          <div class="flex flex-col space-y-1.5">
            <div class="text-sm font-medium text-muted-foreground">Failed</div>
            <div class="text-2xl font-bold text-red-600">
              <%= processRuns.filter(r => r.status === 'FAILED' || r.status ===
              'DATA_FETCH_FAILED').length %>
            </div>
          </div>
        </div>
        <div class="bg-card text-card-foreground rounded-lg border p-6">
          <div class="flex flex-col space-y-1.5">
            <div class="text-sm font-medium text-muted-foreground">
              In Progress
            </div>
            <div class="text-2xl font-bold text-blue-600">
              <%= processRuns.filter(r => ['PENDING', 'STARTED', 'VALIDATING',
              'RUNNING_CHECKS'].includes(r.status)).length %>
            </div>
          </div>
        </div>
      </div>

      <!-- Table -->
      <div class="bg-card text-card-foreground rounded-lg border">
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="border-b bg-muted/50">
                <th
                  class="h-12 px-4 text-left align-middle font-medium text-muted-foreground"
                >
                  ID
                </th>
                <th
                  class="h-12 px-4 text-left align-middle font-medium text-muted-foreground"
                >
                  Field ID
                </th>
                <th
                  class="h-12 px-4 text-left align-middle font-medium text-muted-foreground"
                >
                  Status
                </th>
                <th
                  class="h-12 px-4 text-left align-middle font-medium text-muted-foreground"
                >
                  Data Snapshot ID
                </th>
                <th
                  class="h-12 px-4 text-left align-middle font-medium text-muted-foreground"
                >
                  Created At
                </th>
                <th
                  class="h-12 px-4 text-left align-middle font-medium text-muted-foreground"
                >
                  Updated At
                </th>
              </tr>
            </thead>
            <tbody>
              <% processRuns.forEach((run, index) => { %>
              <tr
                class="border-b transition-colors hover:bg-muted/50 <%= index % 2 === 0 ? 'bg-card' : 'bg-muted/30' %>"
              >
                <td class="p-4 align-middle"><%= run.id %></td>
                <td class="p-4 align-middle font-medium"><%= run.fieldId %></td>
                <td class="p-4 align-middle">
                  <span
                    class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors <%= run.status === 'COMPLETED' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300' : '' %> <%= run.status === 'FAILED' || run.status === 'DATA_FETCH_FAILED' ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300' : '' %> <%= ['PENDING', 'STARTED', 'VALIDATING', 'RUNNING_CHECKS'].includes(run.status) ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300' : '' %> <%= !['COMPLETED', 'FAILED', 'DATA_FETCH_FAILED', 'PENDING', 'STARTED', 'VALIDATING', 'RUNNING_CHECKS'].includes(run.status) ? 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300' : '' %>"
                  >
                    <%= run.status %>
                  </span>
                </td>
                <td class="p-4 align-middle text-muted-foreground">
                  <%= run.dataSnapshotId || 'N/A' %>
                </td>
                <td class="p-4 align-middle text-muted-foreground">
                  <%= run.createdAt ? new Date(run.createdAt).toLocaleString() :
                  'N/A' %>
                </td>
                <td class="p-4 align-middle text-muted-foreground">
                  <%= run.updatedAt ? new Date(run.updatedAt).toLocaleString() :
                  'N/A' %>
                </td>
              </tr>
              <% }); %>
            </tbody>
          </table>
        </div>
      </div>
      <% } else { %>
      <!-- Empty State -->
      <div class="bg-card text-card-foreground rounded-lg border p-12">
        <div
          class="flex flex-col items-center justify-center text-center space-y-4"
        >
          <div class="rounded-full bg-muted p-3">
            <svg
              class="h-6 w-6 text-muted-foreground"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
              ></path>
            </svg>
          </div>
          <div class="space-y-2">
            <h2 class="text-2xl font-semibold tracking-tight">
              No Process Runs Found
            </h2>
            <p class="text-muted-foreground">
              There are no process runs in the database yet.
            </p>
          </div>
        </div>
      </div>
      <% } %>
    </div>
  </body>
</html>
